<!doctype html><html class=no-js lang=en-us prefix="og: https://ogp.me/ns# fb: https://ogp.me/ns/fb#"><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta property="og:title" content="The AWS Integration & Automation team's best practices for Terraform"><meta property="og:type" content="website"><meta property="og:url" content><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=generator content="Hugo 0.92.2"><meta name=description content="Frequently asked questions of the AWS Integration & Automation team about Terraform standards"><meta name=author content="The AWS Integration & Automation team"><link rel="shortcut icon" href=../images/logo.png type=image/png><link rel=icon href=../images/logo.png type=image/png><title>Frequently asked questions (FAQ) :: The AWS Integration & Automation team's best practices for Terraform</title><link href=../css/nucleus.css?1644960958 rel=stylesheet><link href=../css/fontawesome-all.min.css?1644960958 rel=stylesheet><link href=../css/hybrid.css?1644960958 rel=stylesheet><link href=../css/featherlight.min.css?1644960958 rel=stylesheet><link href=../css/perfect-scrollbar.min.css?1644960958 rel=stylesheet><link href=../css/auto-complete.css?1644960958 rel=stylesheet><link href=../css/atom-one-dark-reasonable.css?1644960958 rel=stylesheet><link href=../css/theme.css?1644960958 rel=stylesheet><link href=../css/hugo-theme.css?1644960958 rel=stylesheet><link href=../css/theme-aws.css?1644960958 rel=stylesheet><script src=../js/jquery-3.5.1.min.js?1644960958></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=../faq/><nav id=sidebar><div id=header-wrapper><div id=header><div><a href=../ title="Go home"><img style=vertical-align:middle src=../images/logo.png height=200px></a></div></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../js/lunr.min.js?1644960958></script>
<script type=text/javascript src=../js/auto-complete.js?1644960958></script>
<script type=text/javascript>var baseurl="https://aws-ia.github.io/standards-terraform"</script><script type=text/javascript src=../js/search.js?1644960958></script></div><div class=highlightable><ul class=topics><li data-nav-id=/standards/ title="Terraform Module Standards" class=dd-item><a href=../standards/>Standards</a></li><li data-nav-id=/faq/ title="Frequently asked questions (FAQ)" class="dd-item
parent
active"><a href=../faq/>FAQ</a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/aws-ia><i class="fab fa-github"></i> GitHub</a></li><li><a class=padding href=https://aws.amazon.com/quickstart/architecture/terraform-modules-on-aws/><i class="fab fa-aws"></i> Catalog</a></li><li><a class=padding href=https://aws.amazon.com/quickstart/architecture/terraform-modules-on-aws/>Registry</a></li></ul></section><section id=footer><left><a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | &copy; 2022, Amazon Web Services, Inc. or its affiliates. All rights reserved.</left></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=https://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fa fa-bars"></i></a></span>
<span class=links><a href=https://aws-ia.github.io/standards-terraform/>The AWS Integration & Automation team's best practices for Terraform</a> > Frequently asked questions (FAQ)</span></div></div></div><div id=chapter><div id=body-inner><h1>Frequently asked questions (FAQ)</h1><h2 id=aws-providers-and-associated-modules-demystified>AWS providers and associated modules demystified</h2><p>Terraform leverages providers to interact with infrastructure resources. In the case of AWS, there are two official providers available that can be used; the AWS Provider for Terraform, and the Terraform AWS Cloud Control Provider (AWSCC) provider. The AWS Provider for Terraform has been in existence for over 14 years, and is hand coded (with some code generated). The AWSCC Provider is the newest provider and is automatically generated from the CloudFormation Registry which means new features and services can be supported in Terraform right away.</p><p>Our partners at HashiCorp have a detailed blog post on this topic (<a href=https://www.hashicorp.com/blog/announcing-terraform-aws-cloud-control-provider-tech-preview%29 target=_blank rel="noopener noreferrer">https://www.hashicorp.com/blog/announcing-terraform-aws-cloud-control-provider-tech-preview)</a>. We encourage you to read that blog post.</p><p>The AWS Integration & Automation (AWS I&A) team authors and publishes Terraform modules that have validated provenance. Modules use specific providers in their implementation, and for convenience we have decided on a naming convention that will allow you to know what provider is being used by the module you are leveraging. This naming convention is <code>terraform-&lt;provider>-&lt;modulename></code>.</p><p>For example, you will see a module named <code>terraform-aws-rds-aurora</code> which informs you that this module is leveraging the AWS Provider for Terraform. You would also see another module named <code>terraform-awscc-waf</code> which informs you that it is leveraging the AWSCC Provider. <a href=https://www.hashicorp.com/blog/announcing-terraform-aws-cloud-control-provider-tech-preview#using-two-providers target=_blank rel="noopener noreferrer">You can use both providers side by side</a> and we often do when writing AWSCC modules. The long term goal is to build robust modules that fully utilize the AWSCC provider.</p><p>We standardize on semantic versioning to provide assurance of compatibility and provide robust testing of modules to provide assurance of functionality.</p><p>The AWS CloudControl API and associated AWSCC Provider for Terraform will enable our customers to leverage the newest features and services using the IaC tooling of their choice. The AWS I&A team will prefer the AWSCC Provider when authoring or updating module choice and. Provider and the CloudControl APIs we see the AWSCC Provider mature and move into GA, you will see our newest modules prefer to use the AWSCC Provider.</p><h2 id=what-is-the-user_agent>What is the <code>user_agent</code>?</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=color:#66d9ef>provider</span> <span style=color:#e6db74>&#34;awscc&#34;</span> {
  <span style=color:#a6e22e>user_agent</span> = [{
    <span style=color:#a6e22e>product_name</span>    = <span style=color:#e6db74>&#34;terraform-awscc-label&#34;</span>
    <span style=color:#a6e22e>product_version</span> = <span style=color:#e6db74>&#34;0.0.4&#34;</span>
    <span style=color:#a6e22e>comment</span>         = <span style=color:#e6db74>&#34;V1/AWS-D69B4015/376222271&#34;</span>
  }]
}
</code></pre></div><p>In AWS I&A repos you will see a <code>user_agent</code> defined in the provider block. This is a <a href=https://github.com/hashicorp/terraform-provider-awscc/pull/247 target=_blank rel="noopener noreferrer">feature that was added to AWSCC</a> and is optional. <code>user-agent</code> data is passed to AWS Cloud Control APIs during <code>terraform apply</code>. This is useful for discovery and compliance purposes, as the user-agent for each API call is available as a CloudTrail event. Teams can use this data to identify workloads running in their account such as 3rd party products, OU&rsquo;s, etc. The above example defines 3 fields:</p><ul><li><code>product_name</code>: The user friendly name of the module / repo. github repo names are fungible.</li><li><code>product_version</code>: The tag version of the module.</li><li><code>comment</code>:<ul><li><code>V1</code>: Version 1 of our defined meta-data payload format.</li><li><code>AWS-D69B4015</code>: A unique, searchable identifier.</li><li><code>376222271</code>: The github repo id, should be unique to each module and non-fungible. You can find a repo ID using <code>gh api repos/aws-ia/terraform-awscc-label | jq .id</code>. Download <code>gh</code> <a href=https://cli.github.com/ target=_blank rel="noopener noreferrer">here</a></li></ul></li></ul><p><code>user_agent</code> is a list with entries that are appeneded allowing you to define many in the same block and/or define one per module. We define a <code>user_agent</code> payload per module. This means that a Root module execution will push module meta data to your CloudTrail log.</p><h2 id=recommended-deployment-patterns-for-terraform>Recommended deployment patterns for Terraform</h2><p>There are many ways to deploy or execute Terraform. We recommend either via <a href=https://github.com/aws-ia/terraform-hashicorp-cloud_workspace target=_blank rel="noopener noreferrer">HashiCorp Terraform Cloud</a> or via <a href=https://www.terraform.io/language/settings/backends/s3 target=_blank rel="noopener noreferrer">AWS S3 with DynamoDB for state locking</a>.</p><h2 id=are-modules-protected-by-ci-automation>Are modules protected by CI Automation?</h2><p>Terraform Module pull requests (PRs) are subject to continuous integration (CI) automation for quality, linting, and security scanning. We currently leverage <a href=https://aws.amazon.com/codepipeline/ target=_blank rel="noopener noreferrer">AWS CodePipeline</a> and <a href=https://aws.amazon.com/codecommit/ target=_blank rel="noopener noreferrer">AWS CodeCommit</a>, a process that is private to AWS employees only. It is a heavy work-in-progress and we intend to expose information about it ASAP. For this reason, PRs with <a href=https://github.com/features/actions target=_blank rel="noopener noreferrer">GitHub Actions</a> (and other 3rd party CI tooling) will be automatically rejected. We are open to feedback on what should be included in CI so please use your PR to discuss.</p><footer class=footline></footer></div></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../js/clipboard.min.js?1644960958></script>
<script src=../js/perfect-scrollbar.min.js?1644960958></script>
<script src=../js/perfect-scrollbar.jquery.min.js?1644960958></script>
<script src=../js/jquery.sticky.js?1644960958></script>
<script src=../js/featherlight.min.js?1644960958></script>
<script src=../js/highlight.pack.js?1644960958></script>
<script>hljs.initHighlightingOnLoad()</script><script src=../js/modernizr.custom-3.6.0.js?1644960958></script>
<script src=../js/learn.js?1644960958></script>
<script src=../js/hugo-learn.js?1644960958></script>
<script src=../mermaid/mermaid.js?1644960958></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>