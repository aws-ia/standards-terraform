<!doctype html><html class=no-js lang=en-us prefix="og: https://ogp.me/ns# fb: https://ogp.me/ns/fb#"><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta property="og:title" content="The AWS Integration & Automation team's best practices for Terraform"><meta property="og:type" content="website"><meta property="og:url" content><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=generator content="Hugo 0.92.2"><meta name=description content="The AWS Integration & Automation team's best practices for Terraform"><meta name=author content="The AWS Integration & Automation team"><link rel="shortcut icon" href=./images/logo.png type=image/png><link rel=icon href=./images/logo.png type=image/png><title>The AWS Integration & Automation team's best practices for Terraform :: The AWS Integration & Automation team's best practices for Terraform</title><link href=./css/nucleus.css?1645030604 rel=stylesheet><link href=./css/fontawesome-all.min.css?1645030604 rel=stylesheet><link href=./css/hybrid.css?1645030604 rel=stylesheet><link href=./css/featherlight.min.css?1645030604 rel=stylesheet><link href=./css/perfect-scrollbar.min.css?1645030604 rel=stylesheet><link href=./css/auto-complete.css?1645030604 rel=stylesheet><link href=./css/atom-one-dark-reasonable.css?1645030604 rel=stylesheet><link href=./css/theme.css?1645030604 rel=stylesheet><link href=./css/hugo-theme.css?1645030604 rel=stylesheet><link href=./css/theme-aws.css?1645030604 rel=stylesheet><script src=./js/jquery-3.5.1.min.js?1645030604></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=./><nav id=sidebar><div id=header-wrapper><div id=header><div><a href=./ title="Go home"><img style=vertical-align:middle src=./images/logo.png height=200px></a></div></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=./js/lunr.min.js?1645030604></script>
<script type=text/javascript src=./js/auto-complete.js?1645030604></script>
<script type=text/javascript>var baseurl="https://aws-ia.github.io/standards-terraform"</script><script type=text/javascript src=./js/search.js?1645030604></script></div><div class=highlightable><ul class=topics><li data-nav-id=/standards/ title="Terraform Module Standards" class=dd-item><a href=./standards/>Standards</a></li><li data-nav-id=/faq/ title="Frequently asked questions (FAQ)" class=dd-item><a href=./faq/>FAQ</a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/aws-ia><i class="fab fa-github"></i> GitHub</a></li><li><a class=padding href=https://aws.amazon.com/quickstart/architecture/terraform-modules-on-aws/><i class="fab fa-aws"></i> Catalog</a></li><li><a class=padding href=https://aws.amazon.com/quickstart/architecture/terraform-modules-on-aws/>Registry</a></li></ul></section><section id=footer><left><a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | &copy; 2022, Amazon Web Services, Inc. or its affiliates. All rights reserved.</left></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div id=chapter><div id=body-inner><h1>The AWS Integration & Automation team's best practices for Terraform</h1><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i> navigation</a></span><h4 id=guide-stage-alpha>Guide Stage: <code>Alpha</code></h4><div class="notices note"><p>The aws-ia Terraform standards are updated often. Please be sure to refer to this document often to keep updated!</p></div><h2 id=license>License</h2><ul><li>Licensed under Apache 2.0</li><li>Include Amazon NOTICE.txt</li></ul><h2 id=taxonomy>Taxonomy</h2><p><strong>Root module</strong>: Every Terraform configuration has at least one module, typically known as its root module. In the case of aws-ia modules, the root module is always meant to be made up of reuseable modules or build blocks.</p><p><strong>Child modules</strong>: A module that has been called by another module is often referred to as a child module.</p><p>Types of reuseable aws-ia Modules:</p><ul><li>aws-ia Service Modules: A container that provides a sensible default for deploying an AWS service based on aws-ia standards (Example: VPC/Aurora/SQS)</li><li>aws-ia Partner Modules: A container that leverags one or more AWS Service Modules to build the infrastructure needed to instantiate an AWS partner product (Example: Magento)</li></ul><h2 id=module-structure>Module Structure</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>../terraform-partnername-productname
├── LICENSE
├── NOTICE.txt
├── deploy
│   └── main.tf
├── main.tf
└── setup_workspace
    ├── variables.tf
    └── workspace.tf
</code></pre></div><p><strong>File</strong>: <code>deploy/main.tf</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#75715e># Example deployment using Terraform Cloud
</span><span style=color:#75715e>
</span><span style=color:#75715e># Defaults to TFC for remote backend
</span><span style=color:#75715e></span><span style=color:#66d9ef>terraform</span> {
  <span style=color:#66d9ef>backend</span> <span style=color:#e6db74>&#34;remote&#34;</span> {}
  required_version <span style=color:#f92672>=</span> &#34;&gt;<span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>.<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>5</span><span style=color:#960050;background-color:#1e0010>&#34;</span>
}<span style=color:#75715e>
</span><span style=color:#75715e>
</span><span style=color:#75715e># Use baseline VPC from aws-ia registery
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>&lt;</span><span style=color:#66d9ef>REPLACE</span> <span style=color:#66d9ef>ME</span><span style=color:#960050;background-color:#1e0010>!&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>
</span><span style=color:#75715e># Deploys example workload instance via root module
</span><span style=color:#75715e></span><span style=color:#66d9ef>module</span> <span style=color:#e6db74>&#34;workload&#34;</span> {
  source <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;../&#34;</span><span style=color:#75715e>
</span><span style=color:#75715e>  # interface to be defined
</span><span style=color:#75715e>  #
</span><span style=color:#75715e></span>}
</code></pre></div><p><strong>File</strong>: <code>/main.tf</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#75715e># Root Module
</span><span style=color:#75715e># No backends should be defined by default in Root Module
</span><span style=color:#75715e># This module is intended to be called by one or more other modules and must not contain any provider blocks
</span></code></pre></div><p><strong>File</strong>: <code>/setup_workspace/</code></p><p>Creates the Terraform workspace in TFC. See the <a href=https://registry.terraform.io/modules/aws-ia/cloud_workspace/hashicorp/latest target=_blank rel="noopener noreferrer">registry</a> for more information.</p><h2 id=deployment-types>Deployment Types</h2><p><strong>Local</strong>: Write Terraform state and configuration to local working directory.</p><p><strong>Terraform Cloud (TFC)</strong>: Writes Terraform state and configuration to remote TFC workspace and stream it locally</p><div class="notices note"><p>For more into in how to setup TFC Workspace refer to the cloud_workspace module</p></div><h2 id=development-standards>Development standards</h2><h3 id=minimum-terraform-version>Minimum Terraform version</h3><p><strong>Binary version</strong>: <code>>= 1.0.5</code></p><p><strong>Provider Version</strong>: <code>~> v3.58.0</code></p><h3 id=aws-ia-module-standards>aws-ia module standards</h3><p>Module <code>/main.tf</code> must not contain provider block definitions.</p><p>Deploy example <code>/deploy/main.tf</code> - When creating an example Terraform Cloud deployment for the module are creating refer to the source directly.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#66d9ef>module</span> <span style=color:#e6db74>&#34;self_deployment_example&#34;</span> {
  source <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;../&#34;</span>
}
</code></pre></div><ul><li>If the example terraform cloud deployment requires a VPC or any other AWS service, use the Terraform registry path.</li><li>Lock the version of any dependancies to the latest version at the time of release.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#66d9ef>module</span> <span style=color:#e6db74>&#34;vpc&#34;</span> {
  source    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;aws-ia/vpc/aws&#34;</span>
  version   <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0.0.2&#34;</span>
}
</code></pre></div></div></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=./js/clipboard.min.js?1645030604></script>
<script src=./js/perfect-scrollbar.min.js?1645030604></script>
<script src=./js/perfect-scrollbar.jquery.min.js?1645030604></script>
<script src=./js/jquery.sticky.js?1645030604></script>
<script src=./js/featherlight.min.js?1645030604></script>
<script src=./js/highlight.pack.js?1645030604></script>
<script>hljs.initHighlightingOnLoad()</script><script src=./js/modernizr.custom-3.6.0.js?1645030604></script>
<script src=./js/learn.js?1645030604></script>
<script src=./js/hugo-learn.js?1645030604></script>
<script src=./mermaid/mermaid.js?1645030604></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>